{"version":3,"sources":["SliderRatingQuestion.tsx"],"names":["MIN_VALUE","NPS_MIN_VALUE","getInitialSelectedValue","feedback","answers","parseInt","undefined","getLabelText","isPhone","question","maximumValue","valueData","labelText","type","options","length","SliderRatingQuestion","onFeedback","forgot","themeColor","questionId","scale","dimensionWidthType","DimensionWidthType","phone","styles","phoneStyles","tabletStyles","colorScheme","fontColor","backgroundColor","appearanceBackgroundColor","COLOR_SCHEMES","dark","Colors","appearanceSubBlack","buttonTextSelected","borderColor","color","buttonTextStyle","value","setValue","onSelected","index","getSliderIndicator","Array","keys","map","textStyle","buttonText","commonStyles","container","React","memo","StyleSheet","create","flex","paddingHorizontal","title","fontSize","fontWeight","lineHeight","textAlign","marginBottom","paddingVertical","borderRadius","overflow","borderWidth"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { StyleSheet, Text, TouchableOpacity, ScrollView } from 'react-native';\nimport MandatoryTitle from './MandatoryTitle';\nimport { Colors, addOpacityToColor } from '../styles';\nimport {\n  DimensionWidthType,\n  useDimensionWidthType,\n} from '../hooks/useWindowDimensions';\nimport type {\n  Question as OriginQuestion,\n  Feedback as OriginFeedback,\n} from '../data';\nimport { useTheme, COLOR_SCHEMES } from '../contexts/theme';\nimport { isNil } from 'ramda';\n\ntype Feedback = OriginFeedback & {\n  answers: string[];\n};\n\ntype Question = OriginQuestion & {\n  options: string[];\n  scale: string;\n};\n\ntype Props = {\n  question: Question;\n  onFeedback: ({\n    questionId,\n    answers,\n    type,\n  }: {\n    questionId: string;\n    answers: number[];\n    type: string;\n  }) => void;\n  feedback: Feedback;\n  forgot: boolean;\n  themeColor: string;\n};\n\nconst MIN_VALUE = 1;\nconst NPS_MIN_VALUE = 0;\n\nconst getInitialSelectedValue = (feedback: Feedback) => {\n  if (feedback && feedback.answers && !isNil(feedback.answers[0])) {\n    return parseInt(feedback.answers[0], 10);\n  }\n  return undefined;\n};\n\nconst getLabelText = ({\n  isPhone,\n  question,\n  maximumValue,\n  valueData,\n}: {\n  isPhone: boolean;\n  question: Question;\n  maximumValue: number;\n  valueData: number;\n}) => {\n  const labelText = `${\n    valueData + (question.type === 'nps' ? NPS_MIN_VALUE : MIN_VALUE)\n  }`;\n  if (isPhone) {\n    if (valueData === 0) {\n      return `${labelText} - ${question.options[0]}`;\n    }\n    if (valueData === maximumValue - 1) {\n      return `${labelText} - ${question.options[question.options.length - 1]}`;\n    }\n  }\n  return labelText;\n};\n\nconst SliderRatingQuestion = ({\n  question,\n  onFeedback,\n  feedback,\n  forgot,\n  themeColor,\n}: Props) => {\n  const { questionId, scale } = question;\n\n  const dimensionWidthType = useDimensionWidthType();\n  const isPhone = dimensionWidthType === DimensionWidthType.phone;\n  const styles = isPhone ? phoneStyles : tabletStyles;\n\n  const { colorScheme, fontColor, backgroundColor } = useTheme();\n\n  const appearanceBackgroundColor = addOpacityToColor(\n    colorScheme === COLOR_SCHEMES.dark ? Colors.appearanceSubBlack : themeColor,\n    0.08\n  );\n\n  const buttonTextSelected = {\n    backgroundColor:\n      colorScheme === COLOR_SCHEMES.dark\n        ? addOpacityToColor(themeColor, 0.3)\n        : appearanceBackgroundColor,\n    borderColor: themeColor,\n    color: colorScheme === COLOR_SCHEMES.dark ? fontColor : themeColor,\n  };\n\n  const buttonTextStyle = {\n    backgroundColor: appearanceBackgroundColor,\n    borderColor: backgroundColor,\n    color: fontColor,\n  };\n\n  const [value, setValue] = useState(getInitialSelectedValue(feedback));\n\n  const onSelected = (index: number) => {\n    onFeedback({\n      questionId,\n      answers: [index],\n      type: 'nps',\n    });\n    setValue(index);\n  };\n\n  const maximumValue = parseInt(scale, 10);\n\n  const getSliderIndicator = () => {\n    return [...Array(maximumValue).keys()].map((valueData, index) => {\n      const textStyle =\n        value === index\n          ? [styles.buttonText, buttonTextStyle, buttonTextSelected]\n          : [styles.buttonText, buttonTextStyle];\n      return (\n        <TouchableOpacity key={index} onPress={() => onSelected(index)}>\n          <Text style={textStyle}>\n            {getLabelText({\n              isPhone,\n              question,\n              maximumValue,\n              valueData,\n            })}\n          </Text>\n        </TouchableOpacity>\n      );\n    });\n  };\n\n  return (\n    <ScrollView style={commonStyles.container}>\n      <MandatoryTitle forgot={forgot} question={question} />\n      {getSliderIndicator()}\n    </ScrollView>\n  );\n};\n\nexport default React.memo(SliderRatingQuestion);\n\nconst commonStyles = StyleSheet.create({\n  container: {\n    flex: 1,\n    paddingHorizontal: 42,\n  },\n});\n\nconst phoneStyles = StyleSheet.create({\n  title: {\n    fontSize: 26,\n    fontWeight: '600',\n    lineHeight: 32,\n    textAlign: 'center',\n    marginBottom: 24,\n  },\n  buttonText: {\n    textAlign: 'center',\n    paddingVertical: 9,\n    marginBottom: 10,\n    borderRadius: 17,\n    overflow: 'hidden',\n    borderWidth: 1,\n  },\n});\n\nconst tabletStyles = StyleSheet.create({\n  title: {\n    fontSize: 26,\n    fontWeight: '600',\n    lineHeight: 32,\n    textAlign: 'center',\n    marginBottom: 24,\n  },\n  buttonText: {\n    textAlign: 'center',\n    paddingVertical: 9,\n    marginBottom: 10,\n    borderRadius: 17,\n    overflow: 'hidden',\n    borderWidth: 1,\n  },\n});\n"]}