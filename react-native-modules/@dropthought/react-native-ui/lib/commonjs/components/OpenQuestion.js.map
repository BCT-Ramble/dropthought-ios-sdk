{"version":3,"sources":["OpenQuestion.tsx"],"names":["OpenQuestion","anonymous","question","onFeedback","feedback","forgot","themeColor","backgroundColor","text","setText","React","useState","answers","hasEdited","setHasEdited","isValid","appearanceBackgroundColorStyle","tempFeedback","questionId","type","hasForgot","onEndEditingHandler","onChangeTextHandler","t","upperView","i18n","metaDataType","styles","container","memo","StyleSheet","create","flex","paddingHorizontal"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAIA;;AACA;;AACA;;AAEA;;;;AAWA,MAAMA,YAAY,GAAG,CAAC;AACpBC,EAAAA,SADoB;AAEpBC,EAAAA,QAFoB;AAGpB;AACAC,EAAAA,UAJoB;AAKpBC,EAAAA,QALoB;AAMpBC,EAAAA,MANoB;AAOpBC,EAAAA;AAPoB,CAAD,KAQR;AACX,QAAM;AAAEC,IAAAA;AAAF,MAAsB,sBAA5B;;AACA,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBC,eAAMC,QAAN,CACtBP,QAAQ,SAAR,IAAAA,QAAQ,WAAR,IAAAA,QAAQ,CAAEQ,OAAV,CAAkB,CAAlB,IAAwB,GAAER,QAAH,aAAGA,QAAH,uBAAGA,QAAQ,CAAEQ,OAAV,CAAkB,CAAlB,CAAqB,EAA/C,GAAmD,EAD7B,CAAxB;;AAGA,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4BJ,eAAMC,QAAN,CAAe,KAAf,CAAlC,CALW,CAOX;;;AACA,QAAMI,OAAO,GAAG,yCAA8Bb,QAA9B,EAAwCM,IAAxC,CAAhB;AAEA,QAAMQ,8BAA8B,GAAG;AACrCT,IAAAA,eAAe,EAAEA;AADoB,GAAvC;AAIA;;AACA,QAAMU,YAAY,GAAG;AACnBC,IAAAA,UAAU,EAAEhB,QAAQ,CAACgB,UADF;AAEnBN,IAAAA,OAAO,EAAE,CAACJ,IAAD,CAFU;AAGnBW,IAAAA,IAAI,EAAE;AAHa,GAArB,CAfW,CAqBX;;AACA,QAAMC,SAAS,GACbf,MAAM,IAAI,CAAC,sCAA2BH,QAA3B,EAAqCe,YAArC,CADb;;AAGA,QAAMI,mBAAmB,GAAG,MAAM;AAChCP,IAAAA,YAAY,CAAC,IAAD,CAAZ;AACAX,IAAAA,UAAU,CAAC;AACTe,MAAAA,UAAU,EAAEhB,QAAQ,CAACgB,UADZ;AAETN,MAAAA,OAAO,EAAE,CAACJ,IAAD,CAFA;AAGTW,MAAAA,IAAI,EAAE;AAHG,KAAD,CAAV;AAKD,GAPD;;AASA,QAAMG,mBAAmB,GAAIC,CAAD,IAAe;AACzCd,IAAAA,OAAO,CAACc,CAAD,CAAP;AACD,GAFD;;AAIA,QAAMC,SAAS,gBACb,yEACE,6BAAC,uBAAD;AACE,IAAA,MAAM,EAAEJ,SADV;AAEE,IAAA,cAAc,EACZ;AACAP,IAAAA,SAAS,IAAI,CAACE,OAAd,GACIU,qBAAKF,CAAL,CAAQ,4BAA2BrB,QAAQ,CAACwB,YAAa,EAAzD,CADJ,GAEI,EANR;AAQE,IAAA,QAAQ,EAAExB;AARZ,IADF,CADF;;AAeA,sBACE,6BAAC,uBAAD;AAAY,IAAA,KAAK,EAAE,CAACyB,MAAM,CAACC,SAAR,EAAmBZ,8BAAnB;AAAnB,KACGQ,SADH,eAEE,6BAAC,2BAAD;AACE,IAAA,mBAAmB,EAAEH,mBADvB;AAEE,IAAA,mBAAmB,EAAEC,mBAFvB;AAGE,IAAA,UAAU,EAAEhB,UAHd;AAIE,IAAA,QAAQ,EAAEF,QAJZ;AAKE,IAAA,QAAQ,EAAEF,QALZ;AAME,IAAA,SAAS,EAAED;AANb,IAFF,CADF;AAaD,CA1ED;;4BA4EeS,eAAMmB,IAAN,CAAW7B,YAAX,C;;;;AAEf,MAAM2B,MAAM,GAAGG,wBAAWC,MAAX,CAAkB;AAC/BH,EAAAA,SAAS,EAAE;AACTI,IAAAA,IAAI,EAAE,CADG;AAETC,IAAAA,iBAAiB,EAAE;AAFV;AADoB,CAAlB,CAAf","sourcesContent":["import React from 'react';\nimport { ScrollView, StyleSheet } from 'react-native';\nimport {\n  metaDataTypeQuestionValidator,\n  mandatoryQuestionValidator,\n} from '../utils/data';\nimport MandatoryTitle from './MandatoryTitle';\nimport i18n from '../translation';\nimport { useTheme } from '../contexts/theme';\nimport type { Question, Feedback } from '../data';\nimport MultiLineTextInput from './MultiLineTextInput';\n\ntype Props = {\n  anonymous: boolean;\n  question: Question;\n  onFeedback: (feedback: Feedback) => void;\n  feedback: Feedback;\n  forgot: boolean;\n  themeColor: string;\n};\n\nconst OpenQuestion = ({\n  anonymous,\n  question,\n  // onValueChange, // Keep it for Kiosk usage\n  onFeedback,\n  feedback,\n  forgot,\n  themeColor,\n}: Props) => {\n  const { backgroundColor } = useTheme();\n  const [text, setText] = React.useState<string>(\n    feedback?.answers[0] ? `${feedback?.answers[0]}` : ''\n  );\n  const [hasEdited, setHasEdited] = React.useState(false);\n\n  // It will be used in valid title\n  const isValid = metaDataTypeQuestionValidator(question, text);\n\n  const appearanceBackgroundColorStyle = {\n    backgroundColor: backgroundColor,\n  };\n\n  /** @type {Feedback} */\n  const tempFeedback = {\n    questionId: question.questionId,\n    answers: [text],\n    type: 'open',\n  };\n\n  // It will be used in valid title\n  const hasForgot =\n    forgot && !mandatoryQuestionValidator(question, tempFeedback);\n\n  const onEndEditingHandler = () => {\n    setHasEdited(true);\n    onFeedback({\n      questionId: question.questionId,\n      answers: [text],\n      type: 'open',\n    });\n  };\n\n  const onChangeTextHandler = (t: string) => {\n    setText(t);\n  };\n\n  const upperView = (\n    <>\n      <MandatoryTitle\n        forgot={hasForgot}\n        invalidMessage={\n          // show the error message after the user has done edited\n          hasEdited && !isValid\n            ? i18n.t(`metadata-invalid-message:${question.metaDataType}`)\n            : ''\n        }\n        question={question}\n      />\n    </>\n  );\n\n  return (\n    <ScrollView style={[styles.container, appearanceBackgroundColorStyle]}>\n      {upperView}\n      <MultiLineTextInput\n        onEndEditingHandler={onEndEditingHandler}\n        onChangeTextHandler={onChangeTextHandler}\n        themeColor={themeColor}\n        feedback={feedback}\n        question={question}\n        anonymous={anonymous}\n      />\n    </ScrollView>\n  );\n};\n\nexport default React.memo(OpenQuestion);\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    paddingHorizontal: 42,\n  },\n});\n"]}