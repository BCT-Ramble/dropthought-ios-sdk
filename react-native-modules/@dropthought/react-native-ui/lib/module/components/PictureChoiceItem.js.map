{"version":3,"sources":["PictureChoiceItem.tsx"],"names":["React","useMemo","useState","View","StyleSheet","Image","TouchableOpacity","Text","Dimensions","GlobalStyle","Colors","addOpacityToHex","ActivityIndicatorMask","useTheme","COLOR_SCHEMES","i18n","ChooseIcon","isMultipleChoice","selected","themeColor","iconStyle","tintColor","height","width","cubeStyle","styles","nonSelectedSquare","borderColor","nonSelectedCirle","require","PictureChoiceItem","title","uri","columnGap","onPress","index","fontColor","colorScheme","rtl","dir","itemGapStyle","marginLeft","marginRight","get","questionMargin","itemWidth","Math","floor","loadingImage","setLoadingImage","imageLoadError","setImageLoadError","photo","photoStyle","picture","reloadTextStyle","reloadText","color","reloadStyle","pictureReloadContainer","backgroundColor","reloadPlacholderStyle","reloadPlaceholderImage","row","t","_error","border","containerStyle","borderContainer","borderWidth","rankingBorder","maskStyle","selection","optionContainer","flexRowReverse","textStyle","dark","optionText","appearanceSubBlack","memo","create","flexDirection","marginTop","marginBottom","minHeight","flex","fontSize","paddingHorizontal","borderRadius","alignItems","justifyContent","nonSelectCircle","position","overflow"],"mappings":"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","sourcesContent":["import React, { useMemo, useState } from 'react';\nimport {\n  View,\n  StyleSheet,\n  Image,\n  TouchableOpacity,\n  Text,\n  Dimensions,\n} from 'react-native';\nimport GlobalStyle, { Colors, addOpacityToHex } from '../styles';\nimport ActivityIndicatorMask from './ActivityIndicatorMask';\nimport { useTheme, COLOR_SCHEMES } from '../contexts/theme';\nimport i18n from '../translation';\n\ntype ChooseIconProps = {\n  isMultipleChoice: boolean;\n  selected: boolean;\n  themeColor: string;\n};\nexport const ChooseIcon = ({\n  isMultipleChoice,\n  selected,\n  themeColor,\n}: ChooseIconProps) => {\n  const iconStyle = {\n    tintColor: themeColor,\n    height: 18,\n    width: 18,\n  };\n\n  const cubeStyle = isMultipleChoice\n    ? [styles.nonSelectedSquare, { borderColor: themeColor }]\n    : [styles.nonSelectedCirle, { borderColor: themeColor }];\n\n  return selected ? (\n    <Image\n      style={iconStyle}\n      source={\n        isMultipleChoice\n          ? require('../assets/icCheckBox24Px.png')\n          : require('../assets/ic_picture_select.png')\n      }\n    />\n  ) : (\n    <View style={cubeStyle} />\n  );\n};\n\ntype Props = {\n  title: string;\n  uri: string;\n  isMultipleChoice: boolean;\n  selected: boolean;\n  columnGap: number;\n  onPress: () => void;\n  index: number;\n  themeColor: string;\n};\nconst PictureChoiceItem = ({\n  title,\n  uri,\n  isMultipleChoice,\n  selected,\n  columnGap,\n  onPress,\n  index,\n  themeColor,\n}: Props) => {\n  const { fontColor, colorScheme } = useTheme();\n  const rtl = i18n.dir() === 'rtl';\n\n  const itemGapStyle = useMemo(() => {\n    if (rtl) {\n      return {\n        marginLeft: index % 2 === 0 ? columnGap : 0,\n      };\n    } else {\n      return {\n        marginRight: index % 2 === 0 ? columnGap : 0,\n      };\n    }\n  }, [columnGap, index, rtl]);\n\n  const { width } = Dimensions.get('window');\n  const questionMargin = 30;\n  const itemWidth = Math.floor((width - 2 * questionMargin - columnGap) / 2);\n\n  const [loadingImage, setLoadingImage] = useState(true);\n  const [imageLoadError, setImageLoadError] = useState(false);\n\n  const photo = useMemo(() => {\n    const iconStyle = { tintColor: themeColor };\n    const photoStyle = [styles.picture, { width: itemWidth }];\n    const reloadTextStyle = [\n      styles.reloadText,\n      {\n        color: fontColor,\n      },\n    ];\n    if (imageLoadError) {\n      const reloadStyle = [\n        styles.pictureReloadContainer,\n        {\n          width: itemWidth,\n          backgroundColor: addOpacityToHex(themeColor, 0.1),\n          borderColor: themeColor,\n        },\n      ];\n      const reloadPlacholderStyle = [styles.reloadPlaceholderImage, iconStyle];\n      return (\n        <View style={reloadStyle}>\n          <Image\n            style={reloadPlacholderStyle}\n            source={require('../assets/ic_image_placeholder.png')}\n          />\n          <View style={GlobalStyle.row}>\n            <Image\n              style={iconStyle}\n              source={require('../assets/ic_reload.png')}\n            />\n            <Text style={reloadTextStyle}>\n              {`${i18n.t('picture-choice:reload')}`}\n            </Text>\n          </View>\n        </View>\n      );\n    } else {\n      return (\n        <Image\n          style={photoStyle}\n          source={{ uri }}\n          onLoadStart={() => setLoadingImage(true)}\n          onLoadEnd={() => setLoadingImage(false)}\n          onError={(_error) => {\n            setImageLoadError(true);\n            setLoadingImage(false);\n          }}\n        />\n      );\n    }\n  }, [fontColor, imageLoadError, itemWidth, themeColor, uri]);\n\n  const border = useMemo(() => {\n    const containerStyle = [\n      styles.borderContainer,\n      {\n        borderWidth: selected ? 2 : 1,\n        borderColor: selected ? themeColor : Colors.rankingBorder,\n        width: itemWidth,\n      },\n    ];\n    const maskStyle = {\n      backgroundColor: addOpacityToHex(themeColor, 0.1),\n    };\n    return (\n      <View style={containerStyle}>\n        <ActivityIndicatorMask loading={loadingImage} style={maskStyle} />\n      </View>\n    );\n  }, [itemWidth, loadingImage, selected, themeColor]);\n\n  const selection = useMemo(() => {\n    const containerStyle = [\n      styles.optionContainer,\n      rtl && GlobalStyle.flexRowReverse,\n    ];\n\n    const textStyle =\n      colorScheme === COLOR_SCHEMES.dark\n        ? [styles.optionText, { color: fontColor ?? Colors.appearanceSubBlack }]\n        : [styles.optionText, { color: fontColor }];\n    return (\n      <View style={containerStyle}>\n        <ChooseIcon\n          isMultipleChoice={isMultipleChoice}\n          selected={selected}\n          themeColor={themeColor}\n        />\n        <Text style={textStyle}>{title}</Text>\n      </View>\n    );\n  }, [\n    colorScheme,\n    fontColor,\n    isMultipleChoice,\n    rtl,\n    selected,\n    themeColor,\n    title,\n  ]);\n\n  return (\n    <TouchableOpacity\n      style={itemGapStyle}\n      onPress={() => {\n        if (imageLoadError) {\n          setImageLoadError(false);\n          setLoadingImage(true);\n        } else {\n          onPress();\n        }\n      }}\n    >\n      {/* keep this <View>, otherwise the photo's height will increase accroding to PictureChoiceOtherItem */}\n      <View>\n        {photo}\n        {border}\n        {selection}\n      </View>\n    </TouchableOpacity>\n  );\n};\n\nexport default React.memo(PictureChoiceItem);\n\nconst styles = StyleSheet.create({\n  optionContainer: {\n    flexDirection: 'row',\n    marginTop: 16,\n    marginBottom: 25,\n    minHeight: 20,\n  },\n  optionText: {\n    flex: 1,\n    fontSize: 16,\n    paddingHorizontal: 5,\n  },\n  picture: {\n    height: 138,\n    borderRadius: 12,\n    borderWidth: 1,\n    borderColor: Colors.rankingBorder,\n  },\n  pictureReloadContainer: {\n    height: 138,\n    borderRadius: 12,\n    borderWidth: 1,\n    borderColor: Colors.rankingBorder,\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  reloadPlaceholderImage: {\n    marginBottom: 8,\n  },\n  reloadText: {\n    fontSize: 12,\n    marginLeft: 4,\n  },\n  nonSelectedCirle: {\n    width: 18,\n    height: 18,\n    borderColor: Colors.nonSelectCircle,\n    borderWidth: 1,\n    borderRadius: 9,\n    marginTop: 1,\n  },\n  nonSelectedSquare: {\n    width: 18,\n    height: 18,\n    borderColor: Colors.nonSelectCircle,\n    borderWidth: 1,\n    borderRadius: 2,\n    marginTop: 1,\n  },\n  borderContainer: {\n    position: 'absolute',\n    height: 138,\n    borderRadius: 12,\n    borderColor: 'red',\n    overflow: 'hidden',\n  },\n});\n"]}